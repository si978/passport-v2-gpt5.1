# Passport 统一认证中心 - PRD 审查已决策事项（已归档）

> 状态：**已归档，被综合文档替代**。当前建议直接使用：`passport-统一认证中心-PRD-审查与决策汇总-已决策.md`。
>
> 说明：本文件基于《passport-统一认证中心-PRD-草稿.md》及《passport-统一认证中心-PRD-审查待决策.md》的审查结果，记录 Q-01 ～ Q-19 第一版已确认的产品决策，现已被综合版文档整合，仅保留作为历史记录。

---

## 0. 决策结果总览

| 问题 ID | 选择的方案 | 简要说明 | 已落实位置（文档名称 + 模块 ID） |
| ------- | ---------- | -------- | --------------------------------- |
| Q-01 | 方案 A | SSO 有效期绑定 Refresh Token 生命周期（2 天），同一 Windows 用户下免二次登录 | 《passport-统一认证中心-PRD-草稿.md》1.3 G-02、US-02、FL-04 |
| Q-02 | 方案 A | 明确最小 Token 安全要求（字段、HTTPS、过期时间、app_id 校验） | 《passport-统一认证中心-PRD-草稿.md》1.3 G-03、BR-03～BR-05 |
| Q-03 | 方案 A | 将“2 小时阈值强制删除”上升为网吧安全目标的一部分 | 《passport-统一认证中心-PRD-草稿.md》1.3 G-04、US-03、BR-06、5.4 |
| Q-04 | 方案 A | 本期仅支持九尾狐 & 游利社，其他客户端仅做架构预留 | 《passport-统一认证中心-PRD-草稿.md》2.1 In Scope、2.2 Out of Scope |
| Q-05 | 方案 A | 明确 Temp 与 ProgramData 中 Token/会话文件的分工 | 《passport-统一认证中心-PRD-草稿.md》2.3 前置假设、US-03、BR-06 |
| Q-06 | 方案 A | 为 LocalSession 定义字段白名单，不允许随意扩展 | 《passport-统一认证中心-PRD-草稿.md》3.2 AC-17、8.4 LocalSession |
| Q-07 | 方案 A+B | 区分 Temp Token 文件由系统清理，session.dat 由 2 小时规则兜底 | 《passport-统一认证中心-PRD-草稿.md》US-03、5.4、BR-06 |
| Q-08 | 方案 A | 定义结构级完整性校验（不强制签名），包括必填字段和时间逻辑 | 《passport-统一认证中心-PRD-草稿.md》BR-06 |
| Q-09 | 方案 A | 刷新周期“登录/上次刷新起每 3 小时 + 抖动”，并规定失败重试策略 | 《passport-统一认证中心-PRD-草稿.md》FL-02 |
| Q-10 | 方案 A | 退出入口要求“统一位置 + 2 步内可达” | 《passport-统一认证中心-PRD-草稿.md》7.1 客户端登录相关界面 |
| Q-11 | 方案 A | User.status 统一为 int 枚举：1=正常，0=封禁，-1=注销/删除 | 《passport-统一认证中心-PRD-草稿.md》8.2 User、BR-08 |
| Q-12 | 方案 A | LocalSession.expires_at = created_at + 2 天（与 Refresh Token 对齐） | 《passport-统一认证中心-PRD-草稿.md》8.4 LocalSession、BR-06 |
| Q-13 | 方案 A | LoginLog.logout_time 未做心跳时存储为 NULL，前端展示为“暂无数据” | 《passport-统一认证中心-PRD-草稿.md》8.5 LoginLog |
| Q-14 | 方案 A+B | 在 PRD 中补充 Method/Path/鉴权/幂等概要，并计划独立 API 技术文档 | 《passport-统一认证中心-PRD-草稿.md》9.1.1、9.2 |
| Q-15 | 方案 A | 为本地 SSO 定义 P95 耗时绝对阈值（T ms），具体数值留待性能方案确定 | 《passport-统一认证中心-PRD-草稿.md》10.1 性能 |
| Q-16 | 方案 A | 定义运营/客服/技术支持三类后台角色及对应敏感操作范围 | 《passport-统一认证中心-PRD-草稿.md》11 权限、角色与安全控制 |
| Q-17 | 方案 A | 定义 Passport 最小监控指标集合，并要求全部接入统一监控与告警 | 《passport-统一认证中心-PRD-草稿.md》12.2 监控与告警 |
| Q-18 | 方案 A+B | 给出“账号串用”判定规则与典型场景示例，用于验收 | 《passport-统一认证中心-PRD-草稿.md》17 AC-02、US-03、5.4 |
| Q-19 | 方案 A | “封禁 = 立即全局失效”，封禁后删除 Redis 会话并要求客户端清理本地会话 | 《passport-统一认证中心-PRD-草稿.md》BR-08、6.6 会话管理 |

---

## 1. 决策与原审查文档的关系

- 本文件中的 Q-01 ～ Q-19 与《passport-统一认证中心-PRD-审查待决策.md》中的问题 ID 一一对应。  
- 每个问题的**论证过程、风险分析和备选方案**，可在《passport-统一认证中心-PRD-审查待决策.md》第 3 章“逐条问题决策依据与建议”中查阅：  
  - 例如：
    - Q-01 的背景与可选方案详见《passport-统一认证中心-PRD-审查待决策.md》3.1；
    - Q-19 的背景与可选方案详见同文档 3.19。
- 本“已决策”文档只记录**最终选定的方案**以及它们在《passport-统一认证中心-PRD-草稿.md》中的落地位置，便于以后回溯“某个表述为何如此设计”。

---

## 2. 后续维护建议

1. 若后续对某个问题的决策有变更（例如调整性能阈值 T、扩展后台角色等），请：
   - 在《passport-统一认证中心-PRD-草稿.md》中更新对应章节；
   - 在本文件中追加一条“变更记录”（可在 0 章表格后新增行，标明版本与日期）；
   - 如有需要，在《passport-统一认证中心-PRD-审查待决策.md》中补充新的论证过程。
2. 新增问题建议继续沿用 Q-XX 编号方式（例如从 Q-20 起），并在审查文档与本“已决策”文档中同时维护，保证编号在整个项目周期内不重复。
